<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fabrics – Handmade By July</title>
    <meta
      name="description"
      content="See an overview of the types of fabrics July loves to sew with – gentle cottons, linens, and cozy textures."
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;500;600&family=Work+Sans:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <header class="site-header">
      <div class="shell">
        <a href="index.html" class="brand">
          <img
            src="./assets/logo.png"
            alt="Handmade By July logo – hand-painted sun"
            class="brand-logo"
          />
          <div class="brand-text">
            <span class="brand-title">HANDMADE BY JULY</span>
            <span class="brand-tagline">Sunny, soft, handmade pieces</span>
          </div>
        </a>
        <button class="nav-toggle" aria-label="Toggle navigation">
          <span></span><span></span>
        </button>
        <nav class="nav">
          <a href="index.html">Home</a>
          <a href="products.html">Products</a>
          <a href="fabrics.html">Fabrics</a>
          <a href="index.html#contact">Contact</a>
        </nav>
      </div>
    </header>

    <main>
      <section class="section page-hero">
        <div class="shell">
          <header class="section-heading">
            <h1 class="page-title">Fabrics in my stash</h1>
            <p>
              Here is a small overview of the types of fabrics I love working
              with. When you message me, you can mention any fabric that catches
              your eye.
            </p>
          </header>

          <div class="grid fabrics-grid" data-fabrics-grid></div>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="shell footer-inner">
        <p>Handmade By July ☀</p>
        <p class="footer-small">
          Handmade with love in New York, with lots of sun.
        </p>
      </div>
    </footer>

    <script src="./script.js"></script>
    <script type="module">
      import { createClient } from "https://esm.sh/@supabase/supabase-js";

      const supabaseUrl = "https://bmzavdormblxxmzeoshi.supabase.co";
      const supabaseAnonKey = "sb_publishable_Wap_flAGqOBtAXZzvi9fYg_Xo96ktf5";
      const supabase = createClient(supabaseUrl, supabaseAnonKey);

      const grid = document.querySelector("[data-fabrics-grid]");

      async function loadFabrics() {
        if (!grid) return;
        grid.innerHTML = "";

        const { data: fabrics, error } = await supabase
          .from("fabrics")
          .select("*")
          .order("created_at", { ascending: false });

        if (error) {
          console.error("Error loading fabrics", error);
          const message = document.createElement("p");
          message.textContent =
            "I could not load the fabrics right now. Please try again a bit later.";
          grid.appendChild(message);
          return;
        }

        if (!fabrics || fabrics.length === 0) {
          const message = document.createElement("p");
          message.textContent =
            "No fabrics are listed yet. Once I add them here, they will appear on this page.";
          grid.appendChild(message);
          return;
        }

        fabrics.forEach((fabric) => {
          const card = document.createElement("div");
          card.className = "fabric-card";

          const title = document.createElement("h3");
          title.textContent = fabric.name;

          const description = document.createElement("p");
          description.textContent = fabric.description || "";

          const bestFor = document.createElement("p");
          bestFor.textContent = fabric.best_for || "";

          card.appendChild(title);
          card.appendChild(description);
          card.appendChild(bestFor);

          if (Array.isArray(fabric.tags) && fabric.tags.length > 0) {
            const list = document.createElement("ul");
            list.className = "pill-list";
            fabric.tags.forEach((tag) => {
              const li = document.createElement("li");
              li.textContent = tag;
              list.appendChild(li);
            });
            card.appendChild(list);
          }

          grid.appendChild(card);
        });
      }

      loadFabrics();
    </script>
  </body>
</html>

